document.addEventListener("DOMContentLoaded",()=>{let n,a,e=!1,i=e=>{var t=e=>Array.from(e).reduce((e,t)=>e+t.offsetWidth,0),e=(e&&(e=t(document.querySelector("#blog-info > a").children),t=t(document.getElementById("menus").children),n=e+t,a=document.getElementById("nav")),window.innerWidth<=768||n>a.offsetWidth-120);a.classList.toggle("hide-menu",e)},o={open:()=>{btf.overflowPaddingR.add(),btf.animateIn(document.getElementById("menu-mask"),"to_show 0.5s"),document.getElementById("sidebar-menus").classList.add("open"),e=!0},close:()=>{btf.overflowPaddingR.remove(),btf.animateOut(document.getElementById("menu-mask"),"to_hide 0.5s"),document.getElementById("sidebar-menus").classList.remove("open"),e=!1}},t=()=>{var b=GLOBAL_CONFIG.highlight;if(b){let{highlightCopy:e,highlightLang:f,highlightHeightLimit:h,highlightFullpage:p,highlightMacStyle:t,plugin:v}=b;b=GLOBAL_CONFIG_SITE.isHighlightShrink;let L=e||f||void 0!==b||p||t;var y="highlight.js"===v?document.querySelectorAll("figure.highlight"):document.querySelectorAll('pre[class*="language-"]');if((L||h)&&y.length){let o="prismjs"===v,i=!0===b?"closed":"",l=void 0!==b?'<i class="fas fa-angle-down expand"></i>':"",s=e?'<div class="copy-notice"></div><i class="fas fa-paste copy-button"></i>':"",d=p?'<i class="fa-solid fa-up-right-and-down-left-from-center fullpage-button"></i>':"",t=(e,t)=>{void 0!==GLOBAL_CONFIG.Snackbar?btf.snackbarShow(t):(e.textContent=t,e.style.opacity=1,setTimeout(()=>{e.style.opacity=0},800))},r=e=>{document.queryCommandSupported&&document.queryCommandSupported("copy")?(document.execCommand("copy"),t(e,GLOBAL_CONFIG.copy.success)):t(e,GLOBAL_CONFIG.copy.noSupport)},a=(e,t)=>{var e=e.parentNode,n=(e.classList.add("copy-true"),window.getSelection()),a=document.createRange(),i=o?"pre code":"table .code pre";a.selectNodeContents(e.querySelector(i)),n.removeAllRanges(),n.addRange(a),r(t.previousElementSibling),n.removeAllRanges(),e.classList.remove("copy-true")},c=e=>e.classList.toggle("closed"),m=(e,t)=>{e=e.closest("figure.highlight").classList.toggle("code-fullpage");document.body.style.overflow=e?"hidden":"",t.classList.toggle("fa-down-left-and-up-right-to-center",e),t.classList.toggle("fa-up-right-and-down-left-from-center",!e)},g=e=>{var t=e.target.classList,n=e.currentTarget;t.contains("expand")?c(n):t.contains("copy-button")?a(n,e.target):t.contains("fullpage-button")&&m(n,e.target)},u=e=>e.currentTarget.classList.toggle("expand-done"),n=(e,t)=>{var n,a=document.createDocumentFragment();L&&((n=document.createElement("div")).className="highlight-tools "+i,n.innerHTML='<div class="macStyle"><div class="mac-close"></div><div class="mac-minimize"></div><div class="mac-maximize"></div></div>'+l+e+s+d,btf.addEventListenerPjax(n,"click",g),a.appendChild(n)),h&&(t=>{let a=new Map;(()=>{let e=t;for(;e!==document.body&&null!=e;)"none"===window.getComputedStyle(e).display&&a.set(e,e.getAttribute("style")||""),e=e.parentNode;let n="visibility: hidden !important; display: block !important;";a.forEach((e,t)=>{t.setAttribute("style",e?e+";"+n:n)})})();var e=t.offsetHeight;return a.forEach((e,t)=>{""===e?t.removeAttribute("style"):t.setAttribute("style",e)}),e})(t)>h+30&&((e=document.createElement("div")).className="code-expand-btn",e.innerHTML='<i class="fas fa-angle-double-down"></i>',btf.addEventListenerPjax(e,"click",u),a.appendChild(e)),o?t.parentNode.insertBefore(a,t):t.insertBefore(a,t.firstChild)};y.forEach(e=>{let t="";o&&btf.wrap(e,"figure",{class:"highlight"}),f?(o?t=e.getAttribute("data-language")||"Code":"plain"!==(t=e.getAttribute("class").split(" ")[1])&&void 0!==t||(t="Code"),n(`<div class="code-lang">${t}</div>`,e)):n("",e)})}}},l=()=>{GLOBAL_CONFIG.isPhotoFigcaption&&document.querySelectorAll("#article-container img").forEach(e=>{var t,n=e.title||e.alt;n&&((t=document.createElement("div")).className="img-alt is-center",t.textContent=n,e.insertAdjacentElement("afterend",t))})},s=()=>{btf.loadLightbox(document.querySelectorAll("#article-container img:not(.no-lightbox)"))},d=async e=>(await fetch(e)).json(),r=(i,s,o=!1,l)=>{let d=s.length,r=new InfiniteGrid.JustifiedInfiniteGrid(i,{gap:5,isConstantSize:!0,sizeRange:[150,600],useResizeObserver:!0,observeChildren:!0,useTransform:!0}),c=e=>e.replace(/"/g,"&quot;"),n=(e,t)=>{var n=[],a=(e-1)*t;for(let e=0;e<t;++e){var i=a+e;if(i>=d)break;var i=s[i],o=i.alt?`alt="${c(i.alt)}"`:"",l=i.title?`title="${c(i.title)}"`:"";n.push(`<div class="item">
            <img src="${i.url}" data-grid-maintained-target="true" ${o+l} />
          </div>`)}return n},m=GLOBAL_CONFIG.infinitegrid.buttonText,g=(e,t)=>{r.append(n(e,t),e)},u=Math.ceil(d/10),f=!1,h=e=>{l&&(n=i.parentNode,f&&(n.style.visibility="visible"),0===i.offsetHeight)&&(n.style.visibility="hidden",f=!0);var t,{updated:n,isResize:e,mounted:a}=e;n.length&&a.length&&!e&&(btf.loadLightbox(i.querySelectorAll("img:not(.medium-zoom-image)")),r.getGroups().length===u?(btf.setLoading.remove(i),l||r.off("renderComplete",h)):o&&(btf.setLoading.remove(i),t=i,(n=document.createElement("button")).innerHTML=m+'<i class="fa-solid fa-arrow-down"></i>',n.addEventListener("click",e=>{e.target.closest("button").remove(),btf.setLoading.add(t),g(r.getGroups().length+1,10)},{once:!0}),t.insertAdjacentElement("afterend",n)))},t=btf.debounce(e=>{e=(+e.groupKey||0)+1;g(e,10),e===u&&r.off("requestAppend",t)},300);btf.setLoading.add(i),r.on("renderComplete",h),o?g(1,10):(r.on("requestAppend",t),r.renderItems()),btf.addGlobalFn("pjaxSendOnce",()=>{r.destroy()})},c=async(o,l=!1)=>{var e=async()=>{for(var e of o)if(!btf.isHidden(e)&&!e.classList.contains("loaded")){var t="true"===e.getAttribute("data-button"),n=e.firstElementChild,a=n.textContent;n.textContent="",e.classList.add("loaded");try{var i="url"===e.getAttribute("data-type")?await d(a):JSON.parse(a);r(n,i,t,l)}catch(e){console.error("Gallery data parsing failed:",e)}}};o.length&&("function"!=typeof InfiniteGrid&&await btf.getScript(""+GLOBAL_CONFIG.infinitegrid.js),e())},m=e=>{var e=btf.getScrollPercent(e,document.body),t=document.getElementById("go-up");e<95?(t.classList.add("show-percent"),t.querySelector(".scroll-percent").textContent=e):t.classList.remove("show-percent")},g=()=>{let i=document.getElementById("rightside"),e=window.innerHeight+56,o=0,l=document.getElementById("page-header"),s="undefined"!=typeof chatBtn,d=GLOBAL_CONFIG.percent.rightside,r=()=>document.body.scrollHeight<=e&&(i.classList.add("rightside-show"),!0);if(!r()){let a="";var t=btf.throttle(()=>{var e,t=window.scrollY||document.documentElement.scrollTop,n=(e=(n=t)>o,o=n,e);56<t?(""===a&&(l.classList.add("nav-fixed"),i.classList.add("rightside-show")),n?"down"!==a&&(l.classList.remove("nav-visible"),s&&window.chatBtn.hide(),a="down"):"up"!==a&&(l.classList.add("nav-visible"),s&&window.chatBtn.show(),a="up")):(a="",0===t&&l.classList.remove("nav-fixed","nav-visible"),i.classList.remove("rightside-show")),d&&m(t),r()},300);btf.addEventListenerPjax(window,"scroll",t,{passive:!0})}},u=()=>{let m=GLOBAL_CONFIG_SITE.isToc,g=GLOBAL_CONFIG.isAnchor,n=document.getElementById("article-container");if(n&&(m||g)){let o,l,s,t,d;if(m){let n=document.getElementById("card-toc");l=n.querySelector(".toc-content"),o=l.querySelectorAll(".toc-link"),t=n.querySelector(".toc-percentage"),d=l.classList.contains("is-expand");btf.addEventListenerPjax(l,"click",e=>{var t=e.target.closest(".toc-link");t&&(e.preventDefault(),btf.scrollToDest(btf.getEleTop(document.getElementById(decodeURI(t.getAttribute("href")).replace("#",""))),300),window.innerWidth<900)&&n.classList.remove("open")}),s=e=>{var t=l.clientHeight,n=e.offsetTop,e=e.clientHeight,a=l.scrollTop,n=n-a,t=(t-e)/2;n!=t&&(l.scrollTop=a+(n-t))},l.style.display="block"}let r=n.querySelectorAll("h1,h2,h3,h4,h5,h6"),c="";var e=btf.throttle(()=>{var e=window.scrollY||document.documentElement.scrollTop;m&&GLOBAL_CONFIG.percent.toc&&(t.textContent=btf.getScrollPercent(e,n));{var a=e;if(0!==a){let t="",n="";for(let e=0;e<r.length;e++){var i=r[e];if(!(a>btf.getEleTop(i)-80))break;i=i.id;t=i?"#"+encodeURI(i):"",n=e}if(c!==n&&(g&&btf.updateAnchor(t),c=n,m)&&(l.querySelectorAll(".active").forEach(e=>e.classList.remove("active")),t)){let t=o[n];if(t.classList.add("active"),setTimeout(()=>s(t),0),!d){let e=t.parentNode;for(;!e.matches(".toc");)e.matches("li")&&e.classList.add("active"),e=e.parentNode}}}}},100);btf.addEventListenerPjax(window,"scroll",e,{passive:!0})}},f=n=>{let a=(window.globalFn||{}).themeChange||{};a&&Object.keys(a).forEach(e=>{let t=a[e];["disqus","disqusjs"].includes(e)?setTimeout(()=>t(n),300):t(n)})},h={readmode:()=>{let e=document.body,t=(e.classList.add("read-mode"),document.createElement("button")),n=(t.type="button",t.className="fas fa-sign-out-alt exit-readmode",e.appendChild(t),()=>{e.classList.remove("read-mode"),t.remove(),t.removeEventListener("click",n)});t.addEventListener("click",n)},darkmode:()=>{var e="dark"===document.documentElement.getAttribute("data-theme")?"light":"dark";"dark"==e?(btf.activateDarkMode(),void 0!==GLOBAL_CONFIG.Snackbar&&btf.snackbarShow(GLOBAL_CONFIG.Snackbar.day_to_night)):(btf.activateLightMode(),void 0!==GLOBAL_CONFIG.Snackbar&&btf.snackbarShow(GLOBAL_CONFIG.Snackbar.night_to_day)),btf.saveToLocal.set("theme",e,2),f(e)},"rightside-config":e=>{let t=e.firstElementChild;t.classList.contains("show")&&(t.classList.add("status"),setTimeout(()=>{t.classList.remove("status")},300)),t.classList.toggle("show")},"go-up":()=>{btf.scrollToDest(0,500)},"hide-aside-btn":()=>{var e=document.documentElement.classList,t=e.contains("hide-aside")?"show":"hide";btf.saveToLocal.set("aside-status",t,2),e.toggle("hide-aside")},"mobile-toc-button":(e,t)=>{let n=document.getElementById("card-toc");n.style.transition="transform 0.3s ease-in-out";var a=n.clientHeight,t=t.getBoundingClientRect(),i=window.innerHeight-t.bottom-30;i<a&&(n.style.transformOrigin=`right ${a-i-t.height/2}px`),n.classList.toggle("open"),n.addEventListener("transitionend",()=>{n.style.cssText=""},{once:!0})},"chat-btn":()=>{window.chatBtnFn()},translateLink:()=>{window.translateFn.translatePage()}},p=(document.getElementById("rightside").addEventListener("click",e=>{var t=e.target.closest("[id]");t&&h[t.id]&&h[t.id](e.currentTarget,t)}),()=>{var e=document.querySelectorAll("#article-container table");e.length&&e.forEach(e=>{e.closest(".highlight")||btf.wrap(e,"div",{class:"table-wrap"})})}),v=()=>{var e=document.querySelectorAll("#article-container .hide-button");e.length&&e.forEach(e=>e.addEventListener("click",e=>{e=e.currentTarget;e.classList.add("open"),c(e.nextElementSibling.querySelectorAll(".gallery-container"))},{once:!0}))},L=()=>{var e=document.querySelectorAll("#article-container .tabs");if(e.length){let i=(e,n)=>{e.forEach((e,t)=>{e.classList.toggle("active",t===n)})},n=e=>{var t,n,a=e.target.closest("button");a&&!a.classList.contains("active")&&(t=[...e.currentTarget.children],n=[...e.currentTarget.nextElementSibling.children],a=t.indexOf(a),i(t,a),e.currentTarget.classList.remove("no-default"),i(n,a),c(n[a].querySelectorAll(".gallery-container"),!0))};e.forEach(e=>{var t;btf.addEventListenerPjax(e.firstElementChild,"click",n),btf.addEventListenerPjax(e.lastElementChild,"click",(t=e,e=>{e.target.closest("button")&&btf.scrollToDest(btf.getEleTop(t),300)}))})}},b=e=>{e.forEach(e=>{e.textContent=btf.diffDate(e.getAttribute("datetime"),!0),e.style.display="inline"})};let y=()=>{t(),l(),c(document.querySelectorAll("#article-container .gallery-container")),s(),u(),p(),v(),L()};var w=()=>{var e,t;i(!0),a.classList.add("show"),(t=document.getElementById("recent-posts"))&&t.classList.contains("masonry")&&(t=()=>{let e=new InfiniteGrid.MasonryInfiniteGrid(".recent-post-items",{gap:{horizontal:10,vertical:20},useTransform:!0,useResizeObserver:!0});e.renderItems(),btf.addGlobalFn("pjaxCompleteOnce",()=>{e.destroy()},"removeJustifiedIndexPostUI")},"function"==typeof InfiniteGrid?t():btf.getScript(""+GLOBAL_CONFIG.infinitegrid.js).then(t)),GLOBAL_CONFIG_SITE.isPost?(void 0!==GLOBAL_CONFIG.noticeOutdate&&(()=>{var{limitDay:e,messagePrev:t,messageNext:n,position:a}=GLOBAL_CONFIG.noticeOutdate,i=btf.diffDate(GLOBAL_CONFIG_SITE.postUpdate);e<=i&&((e=document.createElement("div")).className="post-outdate-notice",e.textContent=t+` ${i} `+n,t=document.getElementById("article-container"),"top"===a?t.insertBefore(e,t.firstChild):t.appendChild(e))})(),GLOBAL_CONFIG.relativeDate.post&&b(document.querySelectorAll("#post-meta time"))):(GLOBAL_CONFIG.relativeDate.homepage&&b(document.querySelectorAll("#recent-posts time")),GLOBAL_CONFIG.runtime&&(t=document.getElementById("runtimeshow"))&&(e=t.getAttribute("data-publishDate"),t.textContent=btf.diffDate(e)+" "+GLOBAL_CONFIG.runtime),(t=document.getElementById("last-push-date"))&&(e=t.getAttribute("data-lastPushDate"),t.textContent=btf.diffDate(e,!0)),(t=document.querySelector("#aside-cat-list.expandBtn"))&&btf.addEventListenerPjax(t,"click",e=>{var t=e.target;"I"===t.nodeName&&(e.preventDefault(),t.parentNode.classList.toggle("expand"))},!0)),GLOBAL_CONFIG_SITE.isHome&&(t=document.getElementById("scroll-down"))&&btf.addEventListenerPjax(t,"click",()=>{btf.scrollToDest(document.getElementById("content-inner").offsetTop,300)}),g(),y(),(()=>{var t=document.getElementById("switch-btn");if(t){let e=!1;btf.addEventListenerPjax(t,"click",()=>{document.getElementById("post-comment").classList.toggle("move"),e||"function"!=typeof loadOtherComment||(e=!0,loadOtherComment())})}})(),(t=document.getElementById("toggle-menu"))&&btf.addEventListenerPjax(t,"click",()=>{o.open()})};btf.addGlobalFn("pjaxComplete",w,"refreshFn"),w(),window.addEventListener("resize",()=>{i(!1),e&&btf.isHidden(document.getElementById("toggle-menu"))&&o.close()}),(w=document.getElementById("menu-mask"))&&w.addEventListener("click",()=>{o.close()}),(w=document.querySelector("#sidebar-menus .menus_items"))&&w.addEventListener("click",e=>{e=e.target.closest(".site-page.group");e&&e.classList.toggle("hide")}),GLOBAL_CONFIG.islazyload&&(window.lazyLoadInstance=new LazyLoad({elements_selector:"img",threshold:0,data_src:"lazy-src"}),btf.addGlobalFn("pjaxComplete",()=>{window.lazyLoadInstance.update()},"lazyload")),void 0!==GLOBAL_CONFIG.copyright&&(()=>{let{limitCount:a,languages:i}=GLOBAL_CONFIG.copyright;document.body.addEventListener("copy",e=>{e.preventDefault();var t=window.getSelection(0).toString();let n=t;return t.length>a&&(n=`${t}


${i.author}
${i.link}${window.location.href}
${i.source}
`+i.info),(e.clipboardData?e:window).clipboardData.setData("text",n)})})(),GLOBAL_CONFIG.autoDarkmode&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{void 0===btf.saveToLocal.get("theme")&&(e.matches?f("dark"):f("light"))}),window.addEventListener("hexo-blog-decrypt",e=>{y(),window.translateFn.translateInitialization(),Object.values(window.globalFn.encrypt).forEach(e=>{e()})})});